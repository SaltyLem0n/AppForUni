@model List<YourApp.ViewModels.EmployeeCouponVM>
@{
    ViewData["Title"] = "คูปองจับรางวัล";
    Layout = null;
    int counter = 1;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>พิมพ์คูปอง - RSU360</title>
    <link rel="stylesheet" href="~/css/coupons.css" />
    <script>
        window.addEventListener('load', function () {
            setTimeout(function () {
                window.print();
            }, 500);
        });
    </script>
</head>
<body>
    <div class="toolbar">
        <button class="btn-back" onclick="window.close()">ปิดหน้าต่าง</button>
        <button class="btn-print" onclick="window.print()">พิมพ์ / บันทึกเป็น PDF</button>
    </div>

    @{
        // CRITICAL: Set to 8. This guarantees exactly 2 columns of 4 items.
        // If you leave this at 10, items 9 & 10 will break the page.
        int perPage = 8;
    }

    @for (int i = 0; i < Model.Count; i += perPage)
    {
        <div class="sheet">
            @foreach (var item in Model.Skip(i).Take(perPage))
            {
                <div class="coupon">
                    <div class="c-header">
                        <div class="c-brand">
                            <img src="~/images/logo.png" class="c-logo" alt="Logo" onerror="this.style.display='none'" />
                            <span>คูปองจับรางวัล</span>
                        </div>
                        <span class="c-number">NO. @counter</span>
                    </div>

                    <div class="c-body">
                        <div class="c-info">
                            <div class="c-dept">@item.Department</div>
                            <div class="c-value">@item.EmployeeID</div>
                            <div class="c-value">@item.EmployeeName</div>
                        </div>
                        <div class="c-code-area">
                            <img class="c-barcode-img" src="@item.BarcodeDataUri" />
                        </div>
                    </div>

                    <div class="c-footer">
                        งานเลี้ยงสังสรรค์ปีใหม่ 2569
                    </div>
                </div>
                counter++;
            }
        </div>

        if (i + perPage < Model.Count)
        {
            <div style="page-break-after: always;"></div>
        }
    }
</body>
</html>